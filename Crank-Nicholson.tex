%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Thin Sectioned Essay
% LaTeX Template
% Version 1.0 (3/8/13)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% Original Author:
% Nicolas Diaz (nsdiaz@uc.cl) with extensive modifications by:
% Vel (vel@latextemplates.com)
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[11pt]{article} % Font size (can be 10pt, 11pt or 12pt) and paper size (remove a4paper for US letter paper)

\usepackage[protrusion=true,expansion=true]{microtype} % Better typography
\usepackage{graphicx} % Required for including pictures
\usepackage{wrapfig} % Allows in-line images
\usepackage{amsmath}
\usepackage{mathpazo} % Use the Palatino font
\usepackage{listings} %include code sections
\usepackage[T1]{fontenc} % Required for accented characters
\usepackage[utf8x]{inputenc} % Enecoding used in the document
\usepackage[spanish]{babel}
\linespread{1.05} % Change line spacing here, Palatino benefits from a slight increase by default

\makeatletter
\renewcommand\@biblabel[1]{\textbf{#1.}} % Change the square brackets for each bibliography item from '[1]' to '1.'
\renewcommand{\@listI}{\itemsep=0pt} % Reduce the space between items in the itemize and enumerate environments and the bibliography

\renewcommand{\maketitle}{ % Customize the title - do not edit title and author name here, see the TITLE block below
\begin{flushright} % Right align
{\LARGE\@title} % Increase the font size of the title

\vspace{50pt} % Some vertical space between the title and author name

{\large\@author} % Author name
\\\@date % Date

\vspace{40pt} % Some vertical space between the author block and abstract
\end{flushright}
}

%----------------------------------------------------------------------------------------
%	TITLE
%----------------------------------------------------------------------------------------

\title{\textbf{Solución numérica de ecuaciones diferenciales parciales parabólicas por el método de Crank-Nicolson.}\\ % Title
%Focused and Deliciously Witty Subtitle} % Subtitle
}
\author{\textsc{Roberto Largo Taborda, Duban Arley Medina Eusse} % Author
\\{\textit{Universidad Nacional de Colombia}}} % Institution

\date{\today} % Date

%----------------------------------------------------------------------------------------

\begin{document}

\maketitle % Print the title section

%----------------------------------------------------------------------------------------
%	ABSTRACT AND KEYWORDS
%----------------------------------------------------------------------------------------

\renewcommand{\abstractname}{Resumen} % Uncomment to change the name of the abstract to something else

\begin{abstract}
Las ecuaciones diferenciales parabólicas pueden ser solucionadas computacionalmente mediante dos métodos ampliamente conocidos como lo son el de las diferencias hacia atrás y hacia adelante. El método de diferencias hacia adelante de carácter explicito presenta inestabilidad bajo ciertas condiciones, mientras que el método de las diferencias hacia atrás es de carácter implícito por lo cual es estable, pero con el defecto de que a pesar de que su error de truncación espacial es de orden dos su error de truncación temporal es de orden uno, por lo anterior se hace necesario el estudio de un método que corrija dichos percances. En el presente documento se estudia como surge el método necesario y su implementación computacional.
\end{abstract}

%\hspace*{3,6mm}\textit{Keywords:} lorem , ipsum , dolor , sit amet , lectus % Keywords

\vspace{30pt} % Some vertical space between the abstract and first section

%----------------------------------------------------------------------------------------
%	ESSAY BODY
%----------------------------------------------------------------------------------------

\section*{Introducción}

El método de diferencias hacia adelante es de carácter totalmente explícito, pero con el problema de que sólo para ciertos valores de
\begin{equation}
\lambda =\frac{\alpha ^2 k}{h^2}
\end{equation}
, mas precisamente para
\begin{equation}
\lambda < \frac{1}{2}
\end{equation}, presenta un comportamiento estable en los cálculos. La primera solución ha sido reemplazarlo por el método de diferencias hacia atrás que no tiene ningún problema de estabilidad, aunque a cambio era un método implícito, precisando de la resolución de un sistema lineal para cada avance del tiempo.

Pero ambos llevaban asociados un orden de truncación del tipo $O(h2) + O(k)$, o sea orden 1 en el tiempo, lo que suele ser poco en los casos prácticos en los que una precisión adecuada obliga a distanciar muy poco los nodos de t, o sea a tomar $k$ muy pequeño. Existe un método que, con la dificultad de ser implícito, no tiene problemas de estabilidad y además posee un orden de truncación $O(h^2) + O(k^2)$, permitiendo entonces disminuciones menos importantes del paso k manteniendo una buena precisión de los resultados, Este es el denominado método de Crank-Nicolson.

%------------------------------------------------

\section*{Desarollo matemático}

El probrema a solucionar esta dado por:
$$\frac{\partial u}{\partial t}=\alpha^2\frac{\partial^2 u}{\partial x^2}$$
Bajo las siguientes condiciones:
$$u(x,0)=f(x)$$
$$u(0,t)=0\hspace{1cm}u(l,t)=0$$
Para el método de las diferencias hacia adelante se tiene:
$$\frac{u_{n,m+1}-u_{n,m}}{k}-\alpha^2\frac{u_{n+1,m}-2u_{n,m}+u_{n-1,m}}{h^2}=0$$
Para el método de las diferencias hacia atrás se tiene: 
$$\frac{u_{n,m}-u_{n,m-1}}{k}-\alpha^2\frac{u_{n+1,m}-2u_{n,m}+u_{n-1,m}}{h^2}=0$$
Escribiendo la ecuación anterior para m + 1 y realizando la media aritmética entre el método de las diferencias hacia atrás y hacia adelante se obtiene: 
$$\frac{u_{n,m+1}-u_{n,m}}{k}-\frac{\alpha^2}{2}(\frac{u_{n+1,m}-2u_{n,m}+u_{n-1,m}}{h^2}+\frac{u_{n+1,m+1}-2u_{n,m+1}+u_{n-1,m+1}}{h^2})=0$$
La anterior ecuación es la correspondiente al método de Crank-nicolson, para llevarla a su forma matricial:

$$(1+\lambda)u_{n,m+1}-\frac{\lambda}{2}u_{n+1,m+1}-\frac{\lambda}{2}u_{n-1,m+1}=(1-\lambda)u_{n,m}+\frac{\lambda}{2}u_{n+1,m}+\frac{\lambda}{2}u_{n-1,m}$$
$$u^{(m)}=(u_{1,m},u_{2,m},\ldots,u_{N-1,m})$$
$$A_1u^{(m+1)}=A_2u^{(m)}$$
Donde
$$
A_1=
\begin{bmatrix}
  1+\lambda  & -\frac{\lambda}{2} & 0 & \ldots\\ 
 -\frac{\lambda}{2} & 1+\lambda & -\frac{\lambda}{2} & \ldots\\ 
 0 & -\frac{\lambda}{2} & 1+\lambda & \ldots\\ 
 \vdots & \vdots & \vdots & \ddots 
\end{bmatrix}
$$
$$
A_2=
\begin{bmatrix}
 1-\lambda  & \frac{\lambda}{2} & 0 & \ldots\\ 
 \frac{\lambda}{2} & 1-\lambda & \frac{\lambda}{2} & \ldots\\ 
 0 & \frac{\lambda}{2} & 1-\lambda & \ldots\\ 
 \vdots & \vdots & \vdots & \ddots 
\end{bmatrix}
$$
Podemos escribir en terminos de una solo matriz B a $A_1$ y $A_2$
$$
A_1=I+\frac{\lambda}{2}B
$$
$$
A_2=I-\frac{\lambda}{2}B
$$
donde
$$
B=
\begin{bmatrix}
 2  & -1 & 0 & \ldots\\ 
 -1 & 2 & -1 & \ldots\\ 
 0 & -1 & 2 & \ldots\\ 
 \vdots & \vdots & \vdots & \ddots 
\end{bmatrix}
$$


%------------------------------------------------

\section*{Algoritmo}

\begin{lstlisting}[language=Matlab]
function w = crnkNclsn(L,T,alpha,m,n,funk)
% Funcion que usa el metodo de Crank-Nicolson para aproximar la 
% solucion de la ecuacion diferencial parcial:
%	du/dt (x,t) - alpha^2 d^2u/dx^2 (x,t) = 0
% Sujeta a las condicones de frontera:
%	u(0,t) = u(L,t) = 0, 0<t<T
% Sujeta a las condiciones iniciales:
%	u(x,0) = f(x), 0<=x<=L
% Los argumentos de la funcion son:
%	L : Limite superior de la variable espacial (x).
%	T :Limite superior de la variable temporal (t).
%	alpha :Raiz cuadrada de el coeficiente de la segunda derivada 
% 		espacial.
%	m :Numero de intervalos espaciales para la creacion de la malla.
%	n :Numero de intervalos Temporales para la creacion de la malla.
%	w :Aproximacion a u(x,t) de manera discreta en x y t.
%	funk: Funcion que representa el valor inicial de u(x,0) = f(x).

% inicializar h, k, lambda, y w
h = L./m;
k = T./n;
lambda = (alpha.^2).*k./(h.^2);
w = sparse(m+1,n);

% inicializar primera columna de la matriz w
w(2:m,1) = funk(h.*(1:(m-1)).')

% Se procede a construir las matrices A y B con base en lambda
% Primero se arman matrices que contengan las tres diagonales 
%	principales.
Adiag = repmat([-lambda./2 1+lambda -lambda./2],m-1,1);
Bdiag = repmat([lambda./2 1-lambda lambda./2],m-1,1);
% Despues se organizan en las diagonales de matrices sparse.
A = spdiags(Adiag,[-1 0 1],m-1,m-1)
B = spdiags(Bdiag,[-1 0 1],m-1,m-1)

% Se completa la aproximacion w con un ciclo para solucionar el
% sistema:
%	A w(:,i+1) = B w(:,i)
for i = 1: (n-1)
	w(2:m,i+1) = A\(B*w(2:m,i));
end

% Para presentar la matriz la pasamos de sparse a su version
% completa.
w = full(w);
end
\end{lstlisting}
%------------------------------------------------

\section*{Aplicaciones}

%----------------------------------------------------------------------------------------
%	BIBLIOGRAPHY
%----------------------------------------------------------------------------------------

\bibliographystyle{unsrt}

\bibliography{sample}

%----------------------------------------------------------------------------------------

\end{document}